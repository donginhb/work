<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ZipArchive: Compilation &amp; Integration</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff" leftmargin="32" marginwidth="32" topmargin="32" marginheight="32">
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1><a class="anchor" name="pageSyst">Compilation &amp; Integration</a></h1><dl compact><dt><b></b></dt><dd><ul>
<li><a class="el" href="pageSyst.html#secCompil">Compiling for different implementations and platforms</a><ul>
<li><a class="el" href="pageSyst.html#winMFC">Windows MFC</a></li><li><a class="el" href="pageSyst.html#winSTL">Windows STL</a></li><li><a class="el" href="pageSyst.html#LnxSTL">Linux (STL version)</a></li></ul>
</li><li><a class="el" href="pageSyst.html#sectVisual">Visual C++ : integrating with the project</a><ul>
<li><a class="el" href="pageSyst.html#subsM1">Method 1</a></li><li><a class="el" href="pageSyst.html#subsM2">Method 2 (simpler)</a></li><li><a class="el" href="pageSyst.html#subsDLL">DLL version</a></li></ul>
</li><li><a class="el" href="pageSyst.html#sectBorl">Borland C++ compatibility</a><ul>
<li><a class="el" href="pageSyst.html#subExample">Compiling the sample application</a></li></ul>
</li><li><a class="el" href="pageSyst.html#sectLinux">Linux platform</a><ul>
<li><a class="el" href="pageSyst.html#subsLnxNot">Notes</a></li><li><a class="el" href="pageSyst.html#subsLnxCom">Compiling the library and liniking with the application</a></li></ul>
</li><li><a class="el" href="pageSyst.html#sectNotes">Notes</a><ul>
<li><a class="el" href="pageSyst.html#stlNotes">STL version</a></li><li><a class="el" href="pageSyst.html#subDLLnotes">Compiling as DLL</a></li><li><a class="el" href="pageSyst.html#MFCsample">MFC sample application (ZipArc)</a></li></ul>
</li></ul>
</dd></dl>
<h2><a class="anchor" name="secCompil">
Compiling for different implementations and platforms</a></h2>
The files required for all the library versions are located in the program root directory. You also need to copy additional files to the library root directory from the two more subfolders. Depending on the configuration these files are located in:<h3><a class="anchor" name="winMFC">
Windows MFC</a></h3>
<em>\Windows</em> and <em>\mfc</em> <br>
 You can just execute <em> _copy from Win-MFC.bat </em> batch file.<h3><a class="anchor" name="winSTL">
Windows STL</a></h3>
<em>\Windows</em> and <em>\stl</em> <br>
 You can just execute <em> _copy from Win-STL.bat </em> batch file.<h3><a class="anchor" name="LnxSTL">
Linux (STL version)</a></h3>
<em>\Linux</em> and <em>\stl</em> <br>
 You can just execute <em> _copy_from_Linux.sh </em> script file (don't forget to set executable rights before e.g. with the command: <em> chmod +x _copy_from_Linux.sh </em>).<p>
<dl compact><dt><b>Note:</b></dt><dd>If you are compiling under FreeBSD, Mac, you need to comment include of <code>sys/vfs.h</code> in <em>ZipPlatform.cpp</em> and uncomment includes of <code>sys/param.h</code> and <code>sys/mount.h</code>.<p>
If you use one of the mentioned scripts to copy the files then for easy orientation there will be a file <em>__</em>[...].zcfg created with the name depending on the current configuration</dd></dl>
<h2><a class="anchor" name="sectVisual">
Visual C++ : integrating with the project</a></h2>
To add ZipArchive library functionality into your project you need to link the library to the project. You can do this in at least two ways (in both cases you need to include <a class="el" href="ZipArchive_8h.html">ZipArchive.h</a> header in your sources).<h3><a class="anchor" name="subsM1">
Method 1</a></h3>
Add <em>ZipArchive.lib</em> with the proper path e.g. <em> ..\ZipArchive\debug\ZipArchive.lib </em> to <em> Project Settings-&gt;Link-&gt;Input-&gt;Object/library modules </em> and add ZipArchive library directory to the preprocessor searches (<em> Project Settings -&gt; C++ -&gt; Preprocessor -&gt; Additional include directories </em>).<h3><a class="anchor" name="subsM2">
Method 2 (simpler)</a></h3>
Insert Zip project into workspace and set project dependencies: your project dependent on ZipArchive project (<em> Project -&gt; Dependencies </em> and then on the dialog that will appear you select your project name from the combo box and check the box next to ZipArchive project name). When you use this method, you link configurations in your project with configurations in the ZipArchive project that have the same name in both projects. So if you need to use for example "Static Release" configuration from ZipArchive project, you need to create one with the same name in your application project and make sure that your project uses MFC library and run-time library in same way (<em> Project-&gt;Settings-&gt;General-&gt;Microsoft Fundation Classes </em> and <em> Project-&gt;Settings-&gt; c/c++ -&gt;Code Generation-&gt;Use run-time library </em>).<h3><a class="anchor" name="subsDLL">
DLL version</a></h3>
When you're using the DLL version of the ZipArchive library, you need to define in your program <b>ZIP_HAS_DLL</b> (e.g. in <em> Project Settings -&gt; C++ -&gt; Preprocessor -&gt; Preprocessor definitions </em>). Apart from integrating the ZipArchive library with your program (use one of the methods above), you also need to take into account <em>zlib.lib</em> file (use <em>zlib/zlib.dsw </em> to create it and add to preprocessor includes) or <em>zlib/zlib.dsw</em> project (insert into workspace and set ZipArchive project dependent on it)). Files <em>zlib.dll</em> and <em>ZipArchive.dll</em> must be available for the program when running (e.g. in the program's directory).<p>
You can read about linking problems in the <a class="el" href="pageFaq.html">FAQ</a>.<h2><a class="anchor" name="sectBorl">
Borland C++ compatibility</a></h2>
The library contains a project files for Borland C++ 5.0 ( They were created using Visual C++ Project Conversion Utility (VCTOBPR.EXE). You can start this tool with the command <em> Tools-&gt;Visual C++ Project Conversion Utility </em>.<p>
<dl compact><dt><b>Note:</b></dt><dd>Be sure to create <em>Release</em> subfolder before compiling one of these projects, otherwise you'll get a write error.</dd></dl>
In case the projects provided don't work for you, you can create your own. You need to copy to the root directory appropriate files for <a class="el" href="pageSyst.html#winMFC">MFC</a> or <a class="el" href="pageSyst.html#winSTL">STL</a> versions. You may use the Borland project conversion utility.<p>
<em><b>The library contains also <em>makefiles</em> which should work with other versions of Borland.</b></em><h3><a class="anchor" name="subExample">
Compiling the sample application</a></h3>
There is a Borland C++ project provided with the sample application <code>ZipArc</code>. <br>
 To compile it you need compiled MFC version of ZipArchive library.<p>
<dl compact><dt><b>Note:</b></dt><dd>Be sure to create <em>Release</em> subfolder first, otherwise you'll get a write error.</dd></dl>
Add the library (<em>ZipArchive.lib</em> ) to the project (<em>Project-&gt;Add To Project</em>) and compile.<p>
If you wish to convert Visual C++ project using Visual C++ Project Conversion Utility then after converting to properly compile the application you need to remove <em>odbccp32.lib</em> from the project file and comment everything out in <em>ZipArc_TLB.cpp</em> or remove this file from the project files.<h2><a class="anchor" name="sectLinux">
Linux platform</a></h2>
<h3><a class="anchor" name="subsLnxNot">
Notes</a></h3>
<em> <b>Usage</b> </em><p>
When using the library under Linux you should be aware of a few things:<ul>
<li>after you get the system attributes with <a class="el" href="classCZipFileHeader.html#a18">CZipFileHeader::GetSystemAttr()</a> function, you need to shift them right by 16 (<em> e.g. uAttr = header.GetSystemAttr() &gt;&gt; 16 </em>) - the reason for that is the way the attributes are stored in the archive created under (or for) Linux.</li><li>due to lack of implementation of <a class="el" href="namespaceZipPlatform.html#a23">ZipPlatform::IsDriveRemovable()</a>, which has proven to be a kind of difficult to do, the device containing the archive is always assumed to be removable; the only effect of this is that you need to set <em>iVolumeSize</em> to a value different from 0 when opening with the function <a class="el" href="classCZipArchive.html#a9">CZipArchive::Open()</a> the archive created in tdSpan mode.</li></ul>
<p>
<em> <b>Compiling</b> </em><p>
<ul>
<li>the library was tested under g++ version 3.2.2</li><li>warnings that use of the <code>tempnam</code> and <code>mktemp</code> is not safe can be ignored, because the temporary file is created almost straight away.</li></ul>
<h3><a class="anchor" name="subsLnxCom">
Compiling the library and liniking with the application</a></h3>
<ul>
<li>First you need to copy the appropriate files (<a class="el" href="pageSyst.html#LnxSTL">see above</a>)<br>
</li><li>If you haven't got the zlib library already installed on your system, you can install it using <em>Makefile</em> in the <em>zlib</em> subdirectory (type <em>make</em> and then <em>make install </em>)</li><li>only static version (you can download a full version of the zlib library from the ZipArchive library site). If you don't want to install the zlib library, you need to include it in the ZipArchive library ( edit the <em>Makefile</em> in the main directory and change comments, so that OBJSZLIB is not an empty value but points to zlib library object files)</li><li>Compile the library by typing <em>make</em>. The resulting file is a static library <em>libziparch.a</em> </li><li>You can copy the library and the headers (if you have an appropriate rights) to <em>/usr/lib</em> and <em>/usr/include/ziparchive</em> (you can change them in <em>Makefile</em>) with the command <em>make install</em></li><li>Now you can link the library to your application <br>
 e.g. with the command (if the library is in the same directory)<br>
 <em> g++ $I. -o app app.cpp -lstdc++ -lz libziparch.a</em> <br>
 or if you have the library installed in the /usr subdirectories:<br>
 <em> g++ $I/usr/include/ziparchive -o app app.cpp -lstdc++ -lz -lziparch</em><br>
 If you haven't got the zlib library installed, you need to omit the switch <em>-lz</em> in the above commands. <a class="anchor" name="stlLinuxTest"></a></li><li>There is a <b> test application </b>named <em>zippie.cpp</em> (in <em>stl/zippie</em> which you can compile typing <em>make zippie</em> (providing that you have installed the ZipArchive library). If you haven't got the zlib library installed, you need to switch the comments (comment one line and uncomment another) in the <em>Makefile</em> in the section <em>"zippie:"</em>.</li><li>If you wish to uninstall the library type <em>make uninstall</em></li></ul>
<h2><a class="anchor" name="sectNotes">
Notes</a></h2>
<h3><a class="anchor" name="stlNotes">
STL version</a></h3>
<ul>
<li><b>[Windows only]</b> If your locale is different from English and you wish to use non-English characters in zip files, you need to set your locale with function <em>std::locale::global</em>(std::locale("")) to set it to be the same as your system locale or e.g. <em>std::locale::global</em>(std::locale("French")) to set it to the specified value (do not use <em>_T()</em> macro here when using Unicode); <em>setlocale()</em> function is not sufficient in this case.</li><li>There is a sample application that compiles under Windows (MSVC) and Linux (see below to find out <a class="el" href="pageSyst.html#stlLinuxTest">how to compile it under Linux</a>). This sample application demonstrates most of the ZipArchive library features and is located in <em>stl/zippie</em>.</li></ul>
<h3><a class="anchor" name="subDLLnotes">
Compiling as DLL</a></h3>
<b>[Windows only]</b><ul>
<li>The project that compiles the DLL version of the ZipArchive library needs to have defined <b>ZIP_HAS_DLL, ZIP_BUILD_DLL</b> and also <b>ZLIB_DLL</b>.</li><li>The project that uses the ZipArchive library as the DLL version need to have defined <b>ZIP_HAS_DLL</b></li></ul>
<h3><a class="anchor" name="MFCsample">
MFC sample application (ZipArc)</a></h3>
MFC sample application using ZipArchive library is available separately. Main features:<ul>
<li>MDI application</li><li>multithreaded - you can work with many zip files at one time</li><li>shell integration (remembers the last application used to open zip files and can restore it correctly)</li><li>drag &amp; drop support</li><li>detailed error reports</li><li>you can open and modify SFX archives</li><li>it demonstrates the use of the following functions (most of them are placed in ZipArcDoc.cpp) : <a class="el" href="classCZipArchive.html#a13">CZipArchive::AddNewFile</a>, <a class="el" href="classCZipArchive.html#a46">CZipArchive::Close</a>, <a class="el" href="classCZipArchive.html#a32">CZipArchive::CloseFile</a>, <a class="el" href="classCZipArchive.html#a20">CZipArchive::CloseNewFile</a>, <a class="el" href="classCZipArchive.html#a35">CZipArchive::DeleteFiles</a>, <a class="el" href="classCZipArchive.html#a58">CZipArchive::EnableFindFast</a>, <a class="el" href="classCZipArchive.html#a25">CZipArchive::ExtractFile</a>, <a class="el" href="classCZipArchive.html#a43">CZipArchive::FindFile</a>, <a class="el" href="classCZipArchive.html#a71">CZipArchive::FindMatches</a>, <a class="el" href="classCZipArchive.html#a48">CZipArchive::Flush</a>, <a class="el" href="classCZipArchive.html#a40">CZipArchive::GetArchivePath</a>, <a class="el" href="classCZipArchive.html#a67">CZipArchive::GetCentralDirInfo</a>, <a class="el" href="classCZipArchive.html#a68">CZipArchive::GetCentralDirSize</a>, <a class="el" href="classCZipArchive.html#a41">CZipArchive::GetCurrentDisk</a>, <a class="el" href="classCZipArchive.html#a44">CZipArchive::GetFileInfo</a>, <a class="el" href="classCZipArchive.html#a59">CZipArchive::GetFindFastIndex</a>, <a class="el" href="classCZipArchive.html#a38">CZipArchive::GetGlobalComment</a>, <a class="el" href="classCZipArchive.html#a45">CZipArchive::GetCount</a>, <a class="el" href="classCZipArchive.html#a3">CZipArchive::GetPassword</a>, <a class="el" href="classCZipArchive.html#a42">CZipArchive::GetSpanMode</a>, <a class="el" href="classCZipArchive.html#a47">CZipArchive::IsClosed</a>, <a class="el" href="classCZipArchive.html#a69">CZipArchive::IsReadOnly</a>, <a class="el" href="classCZipArchive.html#a9">CZipArchive::Open</a>, <a class="el" href="classCZipArchive.html#a72">CZipArchive::RenameFile</a>, <a class="el" href="classCZipArchive.html#a63">CZipArchive::PredictExtractedFileName</a>, <a class="el" href="classCZipArchive.html#a4">CZipArchive::SetAdvanced</a>, <a class="el" href="classCZipArchive.html#a6">CZipArchive::SetCallback</a>, <a class="el" href="classCZipArchive.html#a39">CZipArchive::SetFileComment</a>, <a class="el" href="classCZipArchive.html#a37">CZipArchive::SetGlobalComment</a>, <a class="el" href="classCZipArchive.html#a70">CZipArchive::SetIgnoreCRC</a>, <a class="el" href="classCZipArchive.html#a2">CZipArchive::SetPassword</a>, <a class="el" href="classCZipArchive.html#a11">CZipArchive::SetRootPath</a>, <a class="el" href="classCZipArchive.html#a8">CZipArchive::SetSpanCallback</a>, <a class="el" href="classCZipArchive.html#a60">CZipArchive::SetTempPath</a>, <a class="el" href="classCZipArchive.html#a29">CZipArchive::TestFile</a>, <a class="el" href="classCZipArchive.html#a62">CZipArchive::WillBeDuplicated</a>, <br>
 <a class="el" href="classCZipFileHeader.html#a13">CZipFileHeader::IsEncrypted</a>, <a class="el" href="classCZipFileHeader.html#a20">CZipFileHeader::IsDirectory</a>, <a class="el" href="classCZipFileHeader.html#a15">CZipFileHeader::GetTime</a>, <a class="el" href="classCZipFileHeader.html#a17">CZipFileHeader::GetSystemCompatibility</a>, <a class="el" href="classCZipFileHeader.html#a18">CZipFileHeader::GetSystemAttr</a>, <a class="el" href="classCZipFileHeader.html#a16">CZipFileHeader::GetSize</a>, <a class="el" href="classCZipFileHeader.html#a5">CZipFileHeader::GetFileName</a>, <a class="el" href="classCZipFileHeader.html#a10">CZipFileHeader::GetEffComprSize</a>, <a class="el" href="classCZipFileHeader.html#a12">CZipFileHeader::GetCompressionRatio</a>, <a class="el" href="classCZipFileHeader.html#a7">CZipFileHeader::GetComment</a>, <a class="el" href="classCZipFileHeader.html#a11">CZipFileHeader::CompressionEfficient</a>,</li></ul>
<hr><address><small>
ZipArchive Copyright &copy;&nbsp;2000-2005 <a href="mailto:tdracz@artpol-software.com"> Tadeusz Dracz </a>. Generated at Fri Aug 5 21:44:52 2005.
</small></address>
</body>
</html>
